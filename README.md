# Recommender System
The Yelp Recommendation System delivers personalized business suggestions by leveraging users' preferences and past interactions with the platform. Using a combination of collaborative filtering methods and advanced machine learning models, the system ensures highly accurate and relevant recommendations.

It consists of the following:

- LSH using Jaccard Similarity
- Recommender System using Collaborative Filtering, XGBoost, and a Hybrid Model

## 1. Jaccard based LSH

This module implements Locality Sensitive Hashing (LSH) using Jaccard similarity to identify similar businesses from Yelp review data using PySpark.

### Overview

- **Data Preprocessing**: Loads and processes the Yelp dataset, creating a characteristic matrix where each business is represented by a vector of user interactions.
- **LSH & Signature Matrix**: Applies LSH to reduce the dimensionality of the data and generates a signature matrix for efficient similarity estimation.
- **Candidate Pairs & Jaccard Similarity**: Generates candidate business pairs and calculates their Jaccard similarity. Pairs with a similarity â‰¥ 0.5 are retained.

Run the script with: `python local_sensitivity_hashing.py <input_file_path> <output_file_path>`

## 2. Recommendation System

### Pearson Similarity-based Collaborative Filtering

This module implements an Item-Item Collaborative Filtering (CF) recommender system using Pearson similarity to predict ratings for businesses based on user interactions.

#### Overview

- **Data Preprocessing**: Loads Yelp training and validation data, and builds mappings of businesses to users and users to businesses.
- **Rating Calculations**: Computes the average ratings for businesses and prepares user ratings data.
- **Pearson Similarity**: Calculates the Pearson correlation between businesses based on common users' ratings.
- **Prediction**: For each user-business pair in the validation set, predicts the rating using a weighted sum of similar businesses' ratings.
- **Output**: Writes the predicted ratings for each user-business pair to the output file.

### XGBoost Regressor-based Rating Prediction

This module uses an XGBoost Regressor model to predict Yelp ratings based on user and business features.

#### Overview

- **Data Preprocessing**: Loads and processes Yelp training and validation data, along with user and business metadata (from JSON files), extracting relevant features.
- **Feature Engineering**: Constructs user and business-related features such as review count, average stars, and business review counts, alongside user ratings.
- **Model Training**: Uses XGBoost Regressor to train a model based on the extracted features.
- **Prediction**: Predicts ratings for the validation dataset.

### Hybrid Recommendation System: Item-Based and Model-Based

This script implements a **hybrid recommendation system** using **Item-Item Collaborative Filtering** and an **XGBoost Regression Model** to predict user ratings for businesses in Yelp data.

#### Model 1: Item-Based Collaborative Filtering
#### Model 2: XGBoost

The final prediction is generated by combining the predictions from **Model 1** and **Model 2** (XGBoost Regression Model) using a weighted average:

$\text{combined prediction} = \alpha \times (\text{item-based prediction}) + (1 - \alpha) \times (\text{model-based prediction})$

